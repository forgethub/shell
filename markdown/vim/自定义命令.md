### 命令语法

定义命令与定义映射的用法其实很相似：
```vim
:command {lhs} {rhs}
```
只不过在使用自定义命令时，`{lhs}` 是直接输入到命令行中的，当你按下回车时，vim
就将 `{lhs}` 替换为 `{rhs}` 再执行。所以这在形式上与下面这个映射等效：
```vim
: nnoremap :{lhs}<CR> :{rhs}<CR>
```

当然，由于 `:command` 所支持的参数与 `:map` 大相径庭，并不期望你真的按这方式将
自定义命令改成映射。实际上，Vim 的帮助文档中这样描述自定义命令的语法的：
```vim
:command {cmd} {rep}
```

`:command!` 加个叹号修饰则表示重新定义命令 `{cmd}`，否则若之前已定义 `{cmd}`
命令，`:command` 原版会报错。这是为了保护已定义不被覆盖，当你确实要覆盖时，请
加 `!` 后缀。在实践中，一般都是在脚本中定义命令，建议只用 `!` 即可，尤其是在开
发阶段需要调试脚本时，加上 `!` 方便很多。

大部分命令的 `!` 修饰版都是表示强制执行，忽略错误的意思。但上一节介绍的 `:map!` 
的意义太奇葩，建议直接忘记 `:map!` 的用法。

`:command` 命令的退化用法是一致的：
* `:command {cmd}` 列出以 `{cmd}` 开头的自定义命令；
* `:command` 列出所有自定义命令；

Vim 的内置命令都是小写的（除了 `:Next` 与 `:X` `:Print`），所以要求自定义命令
名 `{cmd}` 只能以大写字母开头，其后就类似 VimL 变量名的要求了。然而也不建议在
命令名中使用数字，因为这可能与数字参数混淆。

内置命令可以缩写（这与上节的缩写映射不是同个东西），在没有歧义时，只要输入命令
名的前几个字母就可以了。自定义命令 `{cmd}` 同样可获得此基本福利。不过内置命令
还有更好的福利，就是钦定的缩写，比如 `s` 是替换命令 `substitute` 的缩写，但它
不会与 `set` 发生歧义，而 `set` 的缩写是 `se`。自定义命令却无此特性，只能按基
本规则，输入尽可能多的前缀字符来达到唯一确定命令名的目的。不过缩写只建议在命令
行中使用，在脚本中尽量使用全名。

### 命令属性

在自定义命令时，可支持多种属性，就像 `:map` 的特殊参数（用 `<>` 括起来的）。但
是在 `:command` 中，以一个 `-` 引导一个属性（更像 shell 命令行的选项）。所有属
性必须出现在命令名 `{cmd}` 之前。

* `-buffer` 局部命令，只能用于当前 buffer。
* `-bang` 该自定义命令允许有 `!` 后缀修饰。
* `-register` 第一个参数允许是寄存器名。
* `-bar` 该自定义命令后面允许用 `|` 分隔，接续另一个命令。在这种情况下，`{rep}`
  参数内就不能有 `|` 了，否则会出现解析歧义。

以上这几个属性，只有是 `-buffer` 是常用的，并且建议能局部化时尽量局部化。其他
的属性则较少用到。`-bang` 与 `-register` 只相当于某种特殊参数，而在同一行中用
`|` 使用多个语句（命令）的骚操作，能不用尽量不用。

然后，命令还支持几个复杂的属性，用 `-attribute=value` 表示，允许为属性指定值，
要注意的是等号前后没有空格，而将整体当作 `:command` 命令的一个参数。

* 参数个数，自定义命令 `{cmd}` 允许多少个参数：
  - `-nargs=0` 这是默认行为，不指定该属性就表示命令不接受参数；
  - `-nargs=1` 仅接受一个参数；
  - `-nargs=*` 接受 0 或多个参数；
  - `-nargs=?` 接受 0 或 1 个参数；
  - `-nargs=+` 接受 1 或多个参数。

按常规用法，多个参数用空格分隔（或制表符）。但如果只有一个参数，末尾的空格会被
认为是参数的一部分。否则若要参数中包含空格，请用 `\` 转义。
